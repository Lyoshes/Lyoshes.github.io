<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="theme-color" content="#0b0f14" />
  <title>Elemental Blocks MVP</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" href="favicon.ico" />
</head>
<body>
<canvas id="c"></canvas>
<div class="hud" id="hud"></div>
<div id="remainingHud">Left: 2:00</div>
<div class="hud-right">
  <div id="scoreHud">Score: 0</div>
  <div id="timeHud">Time: 0:00</div>
  <div id="nextLabel">Next</div>
  <canvas id="nextCanvas" width="72" height="72"></canvas>
</div>
<div class="overlay" id="overlay">
  <div class="panel start-panel" id="startPanel">
    <!-- Animated aura background -->
    <div class="menu-aura" aria-hidden="true"></div>
    <!-- Spark layer -->
    <div class="spark-layer" aria-hidden="true"></div>
    
    <!-- Side menu buttons -->
    <div class="side-menu">
      <button class="side-btn" id="startSettingsBtn" aria-label="Settings">‚öô</button>
      <button class="side-btn" id="recordsBtn" aria-label="Records">üèÜ</button>
      <button class="side-btn" id="helpBtn" aria-label="How to play">?</button>
    </div>
    
    <!-- Title -->
    <div class="start-title">
      <h1><span class="title-elemental">Elemental</span><br><span class="title-blocks">Blocks</span></h1>
      <div class="start-subtitle">Close the ring ¬∑ Rise higher</div>
    </div>

    <!-- Stats -->
    <div class="start-stats" id="startStats">
      <div class="stat-row">
        <span class="stat-icon">üèÜ</span>
        <span class="stat-label best-label">Best:</span>
        <span class="stat-value best-value" id="bestScore">0</span>
        <small class="stat-extra" id="bestExtra"></small>
      </div>
      <div class="stat-row">
        <span class="stat-icon">‚è±</span>
        <span class="stat-label">Survive:</span>
        <span class="stat-value" id="surviveVal">2:00</span>
      </div>
    </div>

    <!-- Mode selection -->
    <div class="section-title">Choose tower</div>
    <div class="mode-grid" id="modeGrid">
      <button class="mode-btn active" data-mode="16_20" style="--accRGB:255,216,77">
        <div class="mode-glow" aria-hidden="true"></div>
        <div class="mode-top">
          <div class="mode-name">Quick Tower</div>
        </div>
        <div class="mode-sub">
          <span class="mode-tag acc">Tight ring</span>
          <span class="mode-tag">Fast decisions</span>
          <span class="mode-tag">High risk</span>
        </div>
      </button>
      <button class="mode-btn" data-mode="30_24" style="--accRGB:77,166,255">
        <div class="mode-glow" aria-hidden="true"></div>
        <div class="mode-top">
          <div class="mode-name">High Tower</div>
        </div>
        <div class="mode-sub">
          <span class="mode-tag acc">More space</span>
          <span class="mode-tag">Long run</span>
          <span class="mode-tag">Safer planning</span>
        </div>
      </button>
    </div>

    <!-- Start button -->
    <div class="start-actions">
      <button class="start-btn idlePulse" id="startBtn">
        <span class="start-glow"></span>
        <span class="start-text">Start</span>
      </button>
    </div>

    <!-- Version -->
    <div class="start-version" id="startVersion">v0.13.0</div>
  </div>

  <!-- Game Over panel (styled like pause) -->
  <div class="panel gameover-panel hidden" id="gameoverPanel">
    <div class="menu-aura" aria-hidden="true"></div>
    <div class="ringlines" aria-hidden="true"></div>
    
    <div class="gameover-content">
      <div class="gameover-title">GAME OVER</div>
      
      <div class="gameover-score-grid">
        <!-- Final score card -->
        <div class="gameover-score-card final">
          <div class="gameover-score-top">
            <div class="gameover-label">Score</div>
            <div class="gameover-pill">‚è± <span id="goTime">0:00</span></div>
          </div>
          <div class="gameover-big-score" id="goScore">0</div>
          <div class="gameover-record hidden" id="goNewRecord">üèÜ NEW RECORD!</div>
        </div>
        
        <!-- Matches card -->
        <div class="gameover-score-card stats">
          <div class="gameover-stats-title">MATCHES</div>
          <div class="gameover-stats-grid" id="goMatches"></div>
        </div>
        
        <!-- Bonuses card -->
        <div class="gameover-score-card stats">
          <div class="gameover-stats-title">BONUSES</div>
          <div class="gameover-stats-grid" id="goBonuses"></div>
        </div>
      </div>
      
      <!-- Bottom action buttons -->
      <div class="gameover-actions">
        <button class="gameover-action-btn" id="goRestartBtn" aria-label="Restart" title="Restart">‚Üª</button>
        <button class="gameover-action-btn" id="goExitBtn" aria-label="Exit to Menu" title="Exit to Menu">‚Üê</button>
      </div>
    </div>
  </div>
</div>
<!-- Pause button (replaces settings button during game) -->
<button class="pause-btn hidden" id="pauseBtn" aria-label="Pause">‚è∏</button>

<!-- Pause overlay -->
<div class="overlay hidden" id="pauseOverlay">
  <div class="panel pause-panel">
    <div class="menu-aura" aria-hidden="true"></div>
    <div class="ringlines" aria-hidden="true"></div>
    
    <!-- Left side buttons (settings, sound, music) -->
    <div class="pause-side-btns">
      <button class="pause-circle" id="pauseSettingsBtn" aria-label="Settings" title="Settings">‚öô</button>
      <button class="pause-circle" id="pauseSoundBtn" aria-label="Sound" title="Sound">üîä</button>
      <button class="pause-circle" id="pauseMusicBtn" aria-label="Music" title="Music">üéµ</button>
    </div>
    
    <!-- Content -->
    <div class="pause-content">
      <div class="pause-title">PAUSED</div>
      
      <div class="pause-score-grid">
        <!-- Best score card -->
        <div class="pause-score-card best">
          <div class="pause-score-top">
            <div class="pause-label">Best</div>
            <div class="pause-pill best">üèÜ <span id="pauseBestTime">0:00</span></div>
          </div>
          <div class="pause-big-score" id="pauseBestScore">0</div>
          <div class="pause-meta-row">
            <span>Mode: <small id="pauseBestMode">High Tower</small></span>
          </div>
        </div>
        
        <!-- Current score card -->
        <div class="pause-score-card current">
          <div class="pause-score-top">
            <div class="pause-label">Current</div>
            <div class="pause-pill cur">‚è± <span id="pauseCurrentTime">0:00</span></div>
          </div>
          <div class="pause-big-score" id="pauseCurrentScore">0</div>
          <div class="pause-meta-row">
            <span>Mode: <small id="pauseCurrentMode">High Tower</small></span>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Bottom action buttons (positioned absolute to panel) -->
    <div class="pause-actions">
      <button class="pause-action-btn" id="exitToMenuBtn" aria-label="Exit to Menu" title="Exit to Menu">‚Üê</button>
      <button class="pause-action-btn" id="restartBtn" aria-label="Restart" title="Restart">‚Üª</button>
      <button class="pause-action-btn" id="resumeBtn" aria-label="Resume" title="Resume">‚ñ∂</button>
    </div>
    
    <!-- Confirmation dialog -->
    <div class="confirm-dialog hidden" id="confirmDialog">
      <div class="confirm-box">
        <div class="confirm-text" id="confirmText">Are you sure?</div>
        <div class="confirm-buttons">
          <button class="confirm-btn cancel" id="confirmCancel" aria-label="Cancel">‚úï</button>
          <button class="confirm-btn ok" id="confirmOk" aria-label="Confirm">‚úì</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Settings overlay -->
<div class="overlay hidden" id="settingsOverlay">
  <div class="panel settings-panel">
    <div class="menu-aura" aria-hidden="true"></div>
    <div class="ringlines" aria-hidden="true"></div>
    
    <div class="settings-content">
      <div class="settings-title">SETTINGS</div>
      
      <div class="settings-tabs">
        <button class="tab-btn active" data-tab="controls">Controls</button>
        <button class="tab-btn" data-tab="sounds">Sounds</button>
      </div>

      <div class="tab-content active" id="tab-controls">
        <p class="settings-desc"><b>Swipe left/right:</b> rotate the cylinder</p>
        <p class="settings-desc"><b>Swipe down:</b> faster drop</p>
        <p class="settings-desc"><b>Double tap:</b> rotate piece</p>
        <p class="settings-desc"><b>Button ‚ü≥:</b> rotate piece</p>
        <p class="settings-desc"><b>Magic:</b> Tap an element button, then tap a block of the same color. Fire‚Üíred, Water‚Üíblue, etc.</p>
        <div class="settings-row">
          <span class="settings-label">Invert swipe direction</span>
          <div class="toggle-switch" id="invertSwipeToggle"></div>
        </div>
        <div class="settings-row">
          <span class="settings-label">Fullscreen mode</span>
          <button class="settings-action-btn" id="fullscreenBtn">Enable</button>
        </div>
        <div id="iosHint" class="ios-hint" style="display:none;">
          <b>üì± iOS Safari:</b> Tap <b>Share</b> ‚Üí <b>Add to Home Screen</b> to run in fullscreen mode.
        </div>
        <div id="standaloneBadge" class="standalone-badge" style="display:none;">
          ‚úì Running in standalone mode
        </div>
      </div>

      <div class="tab-content" id="tab-sounds">
        <div class="settings-row">
          <span class="settings-label">Sounds</span>
          <div class="toggle-switch" id="soundsToggle"></div>
        </div>
        <div class="settings-row">
          <span class="settings-label">Music</span>
          <div class="toggle-switch" id="musicToggle"></div>
        </div>
        <div class="settings-row settings-row-sep">
          <span class="settings-label">Sound Volume</span>
          <div class="volume-control">
            <button class="volume-btn" data-volume="0" id="soundVol0">0</button>
            <button class="volume-btn" data-volume="1" id="soundVol1">1</button>
            <button class="volume-btn" data-volume="2" id="soundVol2">2</button>
            <button class="volume-btn" data-volume="3" id="soundVol3">3</button>
            <button class="volume-btn" data-volume="4" id="soundVol4">4</button>
          </div>
        </div>
        <div class="settings-row">
          <span class="settings-label">Music Volume</span>
          <div class="volume-control">
            <button class="volume-btn" data-volume="0" id="musicVol0">0</button>
            <button class="volume-btn" data-volume="1" id="musicVol1">1</button>
            <button class="volume-btn" data-volume="2" id="musicVol2">2</button>
            <button class="volume-btn" data-volume="3" id="musicVol3">3</button>
            <button class="volume-btn" data-volume="4" id="musicVol4">4</button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Close button at bottom -->
    <div class="settings-actions">
      <button class="settings-action-circle" id="settingsClose" aria-label="Close" title="Close">‚úï</button>
    </div>
  </div>
</div>
<div class="controls-right">
  <button class="control-btn" id="dropBtn" aria-label="Drop">‚ñº</button>
  <button class="control-btn" id="rotateBtn" aria-label="Rotate">‚ü≥</button>
</div>
<div class="color-row" aria-label="Magic">
  <button class="color-btn" id="magicRed" data-element="fire" style="background:radial-gradient(circle, #ff4d4d 40%, rgba(14,20,28,0.85) 70%);"><span class="charges">3</span></button>
  <button class="color-btn" id="magicBlue" data-element="water" style="background:radial-gradient(circle, #4da6ff 40%, rgba(14,20,28,0.85) 70%);"><span class="charges">3</span></button>
  <button class="color-btn" id="magicYellow" data-element="lightning" style="background:radial-gradient(circle, #ffd84d 40%, rgba(14,20,28,0.85) 70%);"><span class="charges">3</span></button>
  <button class="color-btn" id="magicGreen" data-element="earth" style="background:radial-gradient(circle, #47d16a 40%, rgba(14,20,28,0.85) 70%);"><span class="charges">3</span></button>
</div>

<script src="bundle.js"></script>
</body>
</html>
